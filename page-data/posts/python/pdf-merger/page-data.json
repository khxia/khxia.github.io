{"componentChunkName":"component---src-templates-blog-template-js","path":"/posts/python/pdf-merger","result":{"data":{"markdownRemark":{"html":"<h2>Introduction</h2>\n<p>I'm sure there has been a time in our lives when we have wanted to merge some PDFs together for whatever reason. If you're on a Mac, then congrats to you because you don't need to worry about things like editing PDFs and whatnot. However, if you're a poor Windows user like me and did not pay for Adobe Acrobat Pro DC, then finding a solution for merging PDFs is not as easy. </p>\n<p align=\"center\">\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d8bfbedc410742dc5ded0e8b172b77bf/066f9/os_meme.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQT/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAeh7rlgaR//EABkQAAMBAQEAAAAAAAAAAAAAAAABEQISIf/aAAgBAQABBQJ9HPmsUShI3hs//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERMRAi/9oACAEBAAY/ApFD0lOSGGH/xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhMVFB/9oACAEBAAE/IQNYIDDrfGMhs57ABRaeTuba5VykWP/aAAwDAQACAAMAAAAQ+z//xAAWEQEBAQAAAAAAAAAAAAAAAAAAEYH/2gAIAQMBAT8Qta//xAAXEQEAAwAAAAAAAAAAAAAAAAAAIVGB/9oACAECAQE/EJpj/8QAHBABAAMAAwEBAAAAAAAAAAAAAQARITFBUWGB/9oACAEBAAE/ENAqLrZirPgVZRaOFAy37FIgdpRnsShAhQ/rICJaeB29T//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"os meme\"\n        title=\"os meme\"\n        src=\"/static/d8bfbedc410742dc5ded0e8b172b77bf/066f9/os_meme.jpg\"\n        srcset=\"/static/d8bfbedc410742dc5ded0e8b172b77bf/651be/os_meme.jpg 170w,\n/static/d8bfbedc410742dc5ded0e8b172b77bf/d30a3/os_meme.jpg 340w,\n/static/d8bfbedc410742dc5ded0e8b172b77bf/066f9/os_meme.jpg 400w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</p>\n<p>Of course, there are websites out there that can automatically merge PDFs for you and there are also free PDF editor apps out there which you can use to merge PDFs. However, there are concerns that people have when they use them. For example, if you are dealing with sensitive documents that contains your personal information (name, address, phone number, ID number) or confidential documents eg. official forms, company documents etc, then you may not want to use an online PDF merger tool since you don't want to be uploading those sensitive documents onto their servers. Free PDF editors apps eg. <a href=\"https://www.sodapdf.com/\">soda PDF</a> are riddled with ads and may require you to pay for premium at some point. </p>\n<p>Anyways, the point is that there may come a time where you want a quick and easy way to merge some PDFs, or manipulate any PDf. Thankfully, there is a Python library called <a href=\"http://mstamy2.github.io/PyPDF2/\">PyPDF2</a> that lets us do this easily. </p>\n<blockquote>\n<details>\n<summary>> Click here to see the full code</summary>\n<p>Too lazy to read? No problem. You can see the full implementation of the PDF merger in the <a href=\"https://github.com/khxia/khxia.github.io/blob/dev2/src/posts/python/mergepdf.py\">Github repo</a></p>\n</details>\n</blockquote>\n<h2>Let's get started</h2>\n<p>So, PyPDF used to be a PDF toolkit that was released in 2005, however in 2011, some other people and a company called <a href=\"http://phaseit.net/\">Phaseit</a> made a new version of PyPDF <em>(they forked it)</em> that could do a wider range of tasks. PyPDF is now no longer being maintained and so everyone, even the creator of PyPDF recommends that we use PyPDF2 - and that is what we will do. </p>\n<blockquote>\n<p>This guide will assume that you already have a Python environment set up and will also assume that you have some basic Python knowledge. </p>\n</blockquote>\n<h3>Installation and Usage</h3>\n<p>There are two main ways that you can download the PyPDF2 library:</p>\n<ol>\n<li>Download the source tarball in the PyPI page <a href=\"https://pypi.org/project/PyPDF2/#files\">here</a></li>\n<li>Or, install it directly through the <code class=\"language-text\">pip</code> command. </li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pip <span class=\"token function\">install</span> PyPDF2</code></pre></div>\n<br>\n<blockquote>\n<p>You can now import the library in your Python code!</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">import</span> PyPDF2 </code></pre></div>\n<br>\n<h2>Implementation</h2>\n<p>Even though PyPDF2 is a relatively broad toolkit and can do many PDF operations eg. </p>\n<ul>\n<li>By-page splitting</li>\n<li>By-page concatentation </li>\n<li>Merging </li>\n<li>Page cropping </li>\n<li>Document encryption and decryption</li>\n<li>Document introspection</li>\n</ul>\n<p>Here, we will just focus on just <strong>merging</strong>. First of all, we need to get the names to our pdf files. For simplicity, I will assume that we want to merge every single pdf file in a folder. To do that we will need the help of the <code class=\"language-text\">os</code> and <code class=\"language-text\">sys</code> libraries. </p>\n<p>Our main function can then look something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n\troot <span class=\"token operator\">=</span> sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># This is the directory containing the PDFs you want to merge</span>\n\tnew_file_name <span class=\"token operator\">=</span> <span class=\"token string\">\"merged.pdf\"</span>\n\tnew_file_path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">,</span> new_file_name<span class=\"token punctuation\">)</span>\n\to_stream <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>new_file_path<span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span>\n\ti_files <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>root <span class=\"token operator\">+</span> <span class=\"token string\">'/'</span> <span class=\"token operator\">+</span> x<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> x<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span><span class=\"token string\">\".pdf\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> x <span class=\"token operator\">!=</span> new_file_name<span class=\"token punctuation\">]</span>\n\t\n    cat_pdf<span class=\"token punctuation\">(</span>i_files<span class=\"token punctuation\">,</span> o_stream<span class=\"token punctuation\">)</span> <span class=\"token comment\"># Some function to combine our PDFs (we haven't defined this yet).</span>\n    \n\to_stream<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>If this looks confusing to you then don't worry, I will break it down for you.</p>\n<p>The first line <code class=\"language-text\">root = sys.argv[1]</code> saves the first argument to the program into a variable called <code class=\"language-text\">root</code>. This is the root directory containing all of the PDF files that we want to merge. The following lines: </p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">new_file_name <span class=\"token operator\">=</span> <span class=\"token string\">\"merged.pdf\"</span>\nnew_file_path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">,</span> new_file_name<span class=\"token punctuation\">)</span>\no_stream <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>new_file_path<span class=\"token punctuation\">,</span> <span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<p>Creates a new file using the <code class=\"language-text\">open()</code> function inside the same directory as the first argument with the name: <code class=\"language-text\">merged.pdf</code>. You can change this name to anything you want. However the <code class=\"language-text\">.pdf</code> extension is mandatory, otherwise your operating system may not know how to interpret the file. Notice, that we called <code class=\"language-text\">open()</code> using the <code class=\"language-text\">wb</code> options. This means that we can use the variable <code class=\"language-text\">o_stream</code> to write to this file in binary mode. If you don't specify <code class=\"language-text\">b</code> for binary mode, it will default to text mode - which is not what we want since PDFs contain more than just text.</p>\n<p>Next we will create a list of our input files: </p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">i_files <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>root <span class=\"token operator\">+</span> <span class=\"token string\">'/'</span> <span class=\"token operator\">+</span> x<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> x<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span><span class=\"token string\">\".pdf\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> x <span class=\"token operator\">!=</span> new_file_name<span class=\"token punctuation\">]</span></code></pre></div>\n<br>\n<p>This is just a really clean, Python-y way of saying: create a list called <code class=\"language-text\">i_files</code> that contains any filename in our directory that matches the condition <code class=\"language-text\">x.endswith(&quot;.pdf&quot;) and x != new_file_name</code>. What the <code class=\"language-text\">os.listdir(root)</code> does is it returns a list of the filenames of the directory specified by <code class=\"language-text\">root</code>. Hence, we can loop over it using the variable <code class=\"language-text\">x</code>. The code below does the exact same thing.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">i_files <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> x<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span><span class=\"token string\">\".pdf\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> x <span class=\"token operator\">!=</span> new_file_name<span class=\"token punctuation\">:</span>\n        i_files<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<p>Now that we have done the preparatory work, we can call a function called <code class=\"language-text\">cat_pdf</code> (that we haven't defined yet) to do all the cool merging work, then we can call <code class=\"language-text\">o_stream.close()</code> to close our file.</p>\n<p>Here comes the fun part: merging the PDFs. There are actually two different ways to do this. We will have a look at both of them. </p>\n<p align=\"center\">\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/85a246d82f092bd07e5db189f2c741e6/36dd4/methods_meme.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.05882352941177%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAf/EABcBAAMBAAAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAVWzvRpOaR//xAAaEAACAgMAAAAAAAAAAAAAAAABEQACAyEi/9oACAEBAAEFAmXTdJhLhHLn/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAx/9oACAEDAQE/ARF//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAQUAAAAAAAAAAAAAAAAAEQABAiCB/9oACAEBAAY/AosUcr//xAAaEAEAAwADAAAAAAAAAAAAAAABABFBITGR/9oACAEBAAE/ITkQtwjuVtL4jMhSHcoBkI//2gAMAwEAAgADAAAAENPP/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAx/9oACAEDAQE/EGEdv//EABcRAQEBAQAAAAAAAAAAAAAAAAERADH/2gAIAQIBAT8QivcFLv/EABsQAQEAAwEBAQAAAAAAAAAAAAERACExQVFh/9oACAEBAAE/ENQHYlYFC+H7lhdE9+sQunWRMJs92xyQsQqecuK1NF4az//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"methods meme\"\n        title=\"methods meme\"\n        src=\"/static/85a246d82f092bd07e5db189f2c741e6/36dd4/methods_meme.jpg\"\n        srcset=\"/static/85a246d82f092bd07e5db189f2c741e6/651be/methods_meme.jpg 170w,\n/static/85a246d82f092bd07e5db189f2c741e6/d30a3/methods_meme.jpg 340w,\n/static/85a246d82f092bd07e5db189f2c741e6/36dd4/methods_meme.jpg 512w\"\n        sizes=\"(max-width: 512px) 100vw, 512px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</p>\n<h3>Method 1</h3>\n<p>The first method is the read and write method. To do that we will need to import two methods from PyPDF2.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">from</span> PyPDF2 <span class=\"token keyword\">import</span> PdfFileReader<span class=\"token punctuation\">,</span> PdfFileWriter</code></pre></div>\n<br>\n<blockquote>\n<p>So our <code class=\"language-text\">cat_pdf</code> function will look something like this:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">def</span> <span class=\"token function\">cat_pdf</span><span class=\"token punctuation\">(</span>input_files<span class=\"token punctuation\">,</span> output_stream<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\tinput_streams <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\t<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n\t\t<span class=\"token keyword\">for</span> input_file <span class=\"token keyword\">in</span> input_files<span class=\"token punctuation\">:</span>\n\t\t\tinput_streams<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>input_file<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\twriter <span class=\"token operator\">=</span> PdfFileWriter<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">for</span> reader <span class=\"token keyword\">in</span> <span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>PdfFileReader<span class=\"token punctuation\">,</span> input_streams<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t\t\t<span class=\"token keyword\">for</span> n <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span>getNumPages<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t\t\t\twriter<span class=\"token punctuation\">.</span>addPage<span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span>getPage<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\twriter<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>output_stream<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">finally</span><span class=\"token punctuation\">:</span>\n\t\t<span class=\"token keyword\">for</span> f <span class=\"token keyword\">in</span> input_streams<span class=\"token punctuation\">:</span>\n\t\t\tf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<p>So the first thing we're going to do is create a new list <code class=\"language-text\">input_stream</code>, which will contain each PDF file that we want to merge in binary format. This is what these lines do:</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">for</span> input_file <span class=\"token keyword\">in</span> input_files<span class=\"token punctuation\">:</span>\n\tinput_streams<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>input_file<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<p>So now, even though we have our PDF files in binary format, we still can't interpret them as PDF files. Which is why we need <code class=\"language-text\">PdfFileReader</code>. The following line basically uses the <code class=\"language-text\">map</code> function, which calls the <code class=\"language-text\">PdfFileReader</code> constructor on every item in <code class=\"language-text\">input_stream</code>, then we can loop over the new list. So now, <code class=\"language-text\">reader</code> will be a single PDF file that we have converted into a PyPDF2 readable format.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">for</span> reader <span class=\"token keyword\">in</span> <span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>PdfFileReader<span class=\"token punctuation\">,</span> input_streams<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></code></pre></div>\n<p>What we're going to do after will be pretty simple. Using the methods of <code class=\"language-text\">PdfFileReader</code>: <code class=\"language-text\">.getNumPages</code> and <code class=\"language-text\">.getPage</code>, and the <code class=\"language-text\">.addPage</code> method of the <code class=\"language-text\">PdfFileWriter</code> class, we are able to iteratively add every single page of every PDF that we want merge into our <code class=\"language-text\">PdfFileWriter</code>. </p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">writer<span class=\"token punctuation\">.</span>addPage<span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span>getPage<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<p>Then, in the end, we are able to write all this data into our new file <code class=\"language-text\">merged.pdf</code> by calling the <code class=\"language-text\">.write</code> method of <code class=\"language-text\">PdfFileWriter</code> on our output stream. The <code class=\"language-text\">PdfFileWriter</code> will hide all the complicated PDF/binary conversions that needs to be made. </p>\n<h3>Method 2</h3>\n<p>So in the previous method, all we used the <code class=\"language-text\">PdfFileWriter</code> and the <code class=\"language-text\">PdfFileReader</code> to perform read and write operations for every page of a PDF. Though this is viable, it can be a little tedious. In fact, for merging, PyPDF2 provides an even more convenient tool called the <code class=\"language-text\">PdfFileMerger</code> which can shorten the process. </p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">from</span> PyPDF2 <span class=\"token keyword\">import</span> PdfFileMerger</code></pre></div>\n<blockquote>\n<p>With this class, our new <code class=\"language-text\">cat_pdf</code> function is a lot shorter:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token keyword\">def</span> <span class=\"token function\">cat_pdf_2</span><span class=\"token punctuation\">(</span>input_files<span class=\"token punctuation\">,</span> output_stream<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\tmerger <span class=\"token operator\">=</span> PdfFileMerger<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">for</span> input_file <span class=\"token keyword\">in</span> input_files<span class=\"token punctuation\">:</span>\n\t\tmerger<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>input_file<span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\tmerger<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>output_stream<span class=\"token punctuation\">)</span></code></pre></div>\n<p>This one doesn't require much explanation. Using the <code class=\"language-text\">.append</code> method of the <code class=\"language-text\">PdfFileMerger</code>, we append the binary format of every PDF we want to merge, and then at the end we call <code class=\"language-text\">.write</code> to write all the PDFs into our output stream. The merger takes care of the rest for us. </p>\n<h2>Conclusion</h2>\n<p>There we go, we have now created a simple program that can merge PDFs for us! While method 2 is perhaps the easier method, the flexibility that method 1 gives us is also quite attractive. Since it appends the PDFs on a page by page basis, we can omit certain pages, reorder pages, or do many of the other cool stuff that <a href=\"https://pythonhosted.org/PyPDF2/PdfFileWriter.html\">PdfFileWriter</a> provides eg. adding bookmarks, adding JavaScript, removing images, removing and adding links etc. </p>\n<p>That being said, PyPDF2 is <strong>not</strong> a universal PDF toolkit and does not \"provide all possible PDF-related functionality\" as stated in the official website (it also links <a href=\"http://phaseit.net/claird/comp.text.pdf/PDF_toolkits.html\">other PDF libraries</a> that you may find useful). However, PyPDF2 is pretty simple to setup and use, so if you are ever stuck in a bind, you know what to do.</p>\n<p>Or you could buy Adobe Acrobat Pro and forget about everything I just said. </p>\n<div align=\"center\">\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b7208490972e3af856acb7d105a210a9/066f9/adobe_meme.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAIBA//aAAwDAQACEAMQAAABrhrnN6bAjDsEaBZ//8QAHBABAQACAgMAAAAAAAAAAAAAAgEAERITIjEy/9oACAEBAAEFAr8znsrxdkBRq68SvabvH7//xAAZEQEAAgMAAAAAAAAAAAAAAAABADECEBH/2gAIAQMBAT8BE5rCo3P/xAAWEQEBAQAAAAAAAAAAAAAAAAABEDH/2gAIAQIBAT8BdhP/xAAaEAACAgMAAAAAAAAAAAAAAAAAIQEgMUFh/9oACAEBAAY/AjJAxOeGqf/EABwQAQACAgMBAAAAAAAAAAAAAAEAIRFRMUFxgf/aAAgBAQABPyFq3uAZOYaIRR1uYVje5wNwkW7+iAx3UuUHktzTxn//2gAMAwEAAgADAAAAEMcnwv/EABkRAAMBAQEAAAAAAAAAAAAAAAABETEhcf/aAAgBAwEBPxC1Xhw39Yqo/8QAFxEBAQEBAAAAAAAAAAAAAAAAAAExEf/aAAgBAgEBPxCqdra6/8QAHRABAQEAAgIDAAAAAAAAAAAAAREAITFBUXGhsf/aAAgBAQABPxCawnuyYyNFgH3NUgKGPtnPCMho47ynY5D40QqeKl/cI4IFU8GWypTpPODbrejf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"adobe meme\"\n        title=\"adobe meme\"\n        src=\"/static/b7208490972e3af856acb7d105a210a9/066f9/adobe_meme.jpg\"\n        srcset=\"/static/b7208490972e3af856acb7d105a210a9/651be/adobe_meme.jpg 170w,\n/static/b7208490972e3af856acb7d105a210a9/d30a3/adobe_meme.jpg 340w,\n/static/b7208490972e3af856acb7d105a210a9/066f9/adobe_meme.jpg 400w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</div>","frontmatter":{"date":"November 20th 2020","path":"/posts/python/pdf-merger","title":"How to create your own custom PDF merger using PyPDF2","topic":"Python"}}},"pageContext":{}},"staticQueryHashes":["3649515864","63159454"]}